{% extends "_layout.html" %}
{% block content %}
<h1>Admin â€“ Products</h1>
<p>
    <a href="{{ url_for('admin_new_product') }}">+ Add New Product</a>
</p>

<table border="1" cellpadding="6" cellspacing="0">
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price</th>
        <th>Stock</th>
        <th>Actions</th>
    </tr>
    {% for p in products %}
    <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.name }}</td>
        <td>{{ "%.2f"|format(p.price) }}</td>
        <td>{{ p.stock }}</td>
        <td>
            <!-- Edit link uses the unified endpoint name available in both blueprint and non-blueprint apps -->
            <a href="{{ url_for('admin_edit_product', product_id=p.id) }}">Edit</a>
            <!-- Delete form posts to the delete route. Confirmation prompt prevents accidental deletion. -->
            <form method="post" action="{{ url_for('admin_delete_product', product_id=p.id) }}" style="display:inline;">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this product?');">
                    Delete
                </button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}